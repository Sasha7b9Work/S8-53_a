#include "Definition.h"
#include "Menu/Pages/PageService.h"
#include "Display/Symbols.h"
#include "FPGA/FPGA.h"
#include "Menu/Menu.h"
#include "Panel/Panel.h"
#include "Hardware/Hardware.h"
#include "Hardware/Sound.h"
#include "Hardware/Timer.h"
#include "Utils/Math.h"


/** @addtogroup Menu
 *  @{
 *  @addtogroup PageService
 *  @{
 */

extern const Page pService;


extern const Button       bResetSettings;               ///< ÑÅÐÂÈÑ - Ñáðîñ íàñòðîåê
static void        OnPress_ResetSettings();
static void FuncDraw();
static void OnTimerDraw();
extern const Button       bAutoSearch;                  ///< ÑÅÐÂÈÑ - Ïîèñê ñèãíàëà
static void        OnPress_AutoSearch();
extern const Page        ppCalibrator;                  ///< ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ
extern const Choice       cCalibrator_Mode;             ///< ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ - Êàëèáðàòîð
static void      OnChanged_Calibrator_Mode(bool active);
extern const Button       cCalibrator_Calibrate;        ///< ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ - Êàëèáðîâàòü
static void        OnPress_Calibrator_Calibrate();
extern const Page        ppMath;                        ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ
extern const Page       pppMath_Function;               ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß
static bool       IsActive_Math_Function();
static void        OnPress_Math_Function();
static void       OnRegSet_Math_Function(int delta);
extern const SmallButton sbMath_Function_Exit;          ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Âûõîä
extern const SmallButton sbMath_Function_ModeDraw;      ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ýêðàí
static void        OnPress_Math_Function_ModeDraw();
static void           Draw_Math_Function_ModeDraw(int x, int y);
static void           Draw_Math_Function_ModeDraw_Disable(int x, int y);
static void           Draw_Math_Function_ModeDraw_Separate(int x, int y);
static void           Draw_Math_Function_ModeDraw_Together(int x, int y);
extern const SmallButton sbMath_Function_Type;          ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Âèä
static void        OnPress_Math_Function_Type();
static void           Draw_Math_Function_Type(int x, int y);
static void           Draw_Math_Function_Type_Sum(int x, int y);
static void           Draw_Math_Function_Type_Mul(int x, int y);
extern const SmallButton sbMath_Function_ModeRegSet;    ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ðåæèì ðó÷êè ÓÑÒÀÍÎÂÊÀ
static void        OnPress_Math_Function_ModeRegSet();
static void           Draw_Math_Function_ModeRegSet(int x, int y);
static void           Draw_Math_Function_ModeRegSet_Range(int x, int y);
static void           Draw_Math_Function_ModeRegSet_RShift(int x, int y);
extern const SmallButton sbMath_Function_RangeA;        ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ìàñøòàá 1-ãî êàíàëà
static void        OnPress_Math_Function_RangeA();
static void           Draw_Math_Function_RangeA(int x, int y);
extern const SmallButton sbMath_Function_RangeB;        ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ìàñøòàá 2-ãî êàíàëà
static void        OnPress_Math_Function_RangeB();
static void           Draw_Math_Function_RangeB(int x, int y);
extern const Page       pppMath_FFT;                    ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ
static void        OnPress_Math_FFT();
static bool       IsActive_Math_FFT();
extern const Choice       cMath_FFT_Enable;             ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Îòîáðàæåíèå
extern const Choice       cMath_FFT_Scale;              ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Øêàëà
extern const Choice       cMath_FFT_Source;             ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Èñòî÷íèê
extern const Choice       cMath_FFT_Window;             ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Îêíî
extern const Page      ppppMath_FFT_Cursors;            ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ
static bool       IsActive_Math_FFT_Cursors();
static void       OnRegSet_Math_FFT_Cursors(int angle);
extern const SmallButton  cMath_FFT_Cursors_Exit;        ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ - Âûõîä
static void        OnPress_Math_FFT_Cursors_Exit();
extern const SmallButton  cMath_FFT_Cursors_Source;      ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ - Èñòî÷íèê
static void        OnPress_Math_FFT_Cursors_Source();
static void           Draw_Math_FFT_Cursors_Source(int x, int y);
extern const Choice       cMath_FFT_Limit;              ///< ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Äèàïàçîí
static bool       IsActive_Math_FFT_Limit();
extern const Page        ppEthernet;                    ///< ÑÅÐÂÈÑ - ETHERNET
extern const Choice       cEthernet_Enable;             ///< ÑÅÐÂÈÑ - ETHERNET - Ethernet
static void      OnChanged_Ethernet_Enable(bool active);
extern const IPaddress   ipEthernet_IP;                 ///< ÑÅÐÂÈÑ - ETHERNET - IP àäðåñ
extern const IPaddress   ipEthernet_Mask;               ///< ÑÅÐÂÈÑ - ETHERNET - Ìàñêà ïîäñåòè
extern const IPaddress   ipEthernet_Gateway;            ///< ÑÅÐÂÈÑ - ETHERNET - Øëþç
extern const MACaddress macEthernet_MAC;                ///< ÑÅÐÂÈÑ - ETHERNET - Ôèç àäðåñ
extern const Choice       cSound;                       ///< ÑÅÐÂÈÑ - Çâóê
extern const Choice       cLang;                        ///< ÑÅÐÂÈÑ - ßçûê
extern const Time         tTime;                        ///< ÑÅÐÂÈÑ - Âðåìÿ
extern const Choice       cModeLongPressButtonTrig;     ///< ÑÅÐÂÈÑ - Ðåæ äëèò ÑÈÍÕÐ
extern const Page        ppInformation;                 ///< ÑÅÐÂÈÑ - ÈÍÔÎÐÌÀÖÈß
static void        OnPress_Information();
static void Information_Draw();
extern const SmallButton sbInformation_Exit;             ///< ÑÅÐÂÈÑ - ÈÍÔÎÐÌÀÖÈß - Âûõîä
static void        OnPress_Information_Exit();

extern Page mainPage;

// ÑÅÐÂÈÑ ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static const arrayItems itemsService =
{
    (void*)&bResetSettings,             // ÑÅÐÂÈÑ - Ñáðîñ íàñòðîåê
    (void*)&bAutoSearch,                // ÑÅÐÂÈÑ - Ïîèñê ñèãíàëà
    (void*)&ppCalibrator,               // ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ
    (void*)&ppMath,                     // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ
    (void*)&ppEthernet,                 // ÑÅÐÂÈÑ - ETHERNET
    (void*)&cSound,                     // ÑÅÐÂÈÑ - Çâóê
    (void*)&cLang,                      // ÑÅÐÂÈÑ - ßçûê
    (void*)&tTime,                      // ÑÅÐÂÈÑ - Âðåìÿ
    (void*)&cModeLongPressButtonTrig,   // ÑÅÐÂÈÑ - Ðåæ äëèò ÑÈÍÕÐ
    (void*)&ppInformation               // ÑÅÐÂÈÑ - ÈÍÔÎÐÌÀÖÈß
};

const Page pService                     ///< ÑÅÐÂÈÑ
(
    &mainPage, 0,
    "ÑÅÐÂÈÑ", "SERVICE",
    "Äîïîëíèòåëüíûå íàñòðîéêè, êàëèáðîâêà, ïîèñê ñèãíàëà, ìàòåìàòè÷åñêèå ôóíêöèè",
    "Additional settings, calibration, signal search, mathematical functions",
    Page_Service, &itemsService
);

// ÑÅÐÂÈÑ - Ñáðîñ íàñòðîåê ---------------------------------------------------------------------------------------------------------------------------
static const Button bResetSettings
(
    &pService, 0,
    "Ñáðîñ íàñòðîåê", "Reset settings",
    "Ñáðîñ íàñòðîåê íà íàñòðîéêè ïî óìîë÷àíèþ",
    "Reset to default settings",
    OnPress_ResetSettings
);

static void OnPress_ResetSettings(void)
{
    Panel::Disable();
    Display::SetDrawMode(DrawMode_Hand, FuncDraw);
    Timer::Enable(kTimerDrawHandFunction, 100, OnTimerDraw);

    if (Panel::WaitPressingButton() == B_Start)
    {
        Settings::Load(true);
        FPGA::Init();
    }

    Timer::Disable(kTimerDrawHandFunction);
    Display::SetDrawMode(DrawMode_Auto, 0);
    Panel::Enable();
}

static void FuncDraw(void)
{
    Painter::BeginScene(COLOR_BACK);

    Painter::DrawTextInRectWithTransfersC(30, 110, 300, 200, "Ïîäòâåðäèòå ñáðîñ íàñòðîåê íàæàòèåì êíîïêè ÏÓÑÊ/ÑÒÎÏ.\n"
                                         "Íàæìèòå ëþáóþ äðóãóþ êíîïêó, åñëè ñáðîñ íå íóæåí.", COLOR_FILL);

    Painter::EndScene();
}

static void OnTimerDraw(void)
{
    Display::Update();
}


// ÑÅÐÂÈÑ - Ïîèñê ñèãíàëà ----------------------------------------------------------------------------------------------------------------------------
static const Button bAutoSearch
(
    &pService, 0,
    "Ïîèñê ñèãíàëà", "Find signal",
    "Óñòàíàâëèâàåò îïòèìàëüíûå óñòàíîâêè îñöèëëîãðàôà äëÿ ñèãíàëà â êàíàëå 1",
    "Sets optimal settings for the oscilloscope signal on channel 1",
    OnPress_AutoSearch
);

static void OnPress_AutoSearch(void)
{
    FPGA::StartAutoFind();
};

// ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static const arrayItems itemsCalibrator =
{
    (void*)&cCalibrator_Mode,       // ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ - Êàëèáðàòîð
    (void*)&cCalibrator_Calibrate   // ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ - Êàëèáðîâàòü
};

static const Page ppCalibrator
(
    &pService, 0,
    "ÊÀËÈÁÐÀÒÎÐ", "CALIBRATOR",
    "Óïðàâëåíèåì êàëèáðàòîðîì è êàëèáðîâêà îñöèëëîãðàôà",
    "Control of the calibrator and calibration of an oscillograph",
    Page_ServiceCalibrator, &itemsCalibrator
);

// ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ - Êàëèáðàòîð ------------------------------------------------------------------------------------------------------------------
static const Choice cCalibrator_Mode =
{
    Item_Choice, &ppCalibrator, 0,
    {
        "Êàëèáðàòîð",  "Calibrator",
        "Ðåæèì ðàáîòû êàëèáðàòîðà",
        "Mode of operation of the calibrator"
    },
    {
        {"Ïåðåì",   "DC"},
        {"Ïîñò",    "AC"},
        {"0Â",      "OV"}
    },
    (int8*)&CALIBRATOR, OnChanged_Calibrator_Mode
};

static void OnChanged_Calibrator_Mode(bool active)
{
    FPGA::SetCalibratorMode(CALIBRATOR);
}

// ÑÅÐÂÈÑ - ÊÀËÈÁÐÀÒÎÐ - Êàëèáðîâàòü -----------------------------------------------------------------------------------------------------------------
static const Button cCalibrator_Calibrate
(
    &ppCalibrator, 0,
    "Êàëèáðîâàòü", "Calibrate",
    "Çàïóñê ïðîöåäóðû êàëèáðîâêè",
    "Running the calibration procedure",
    OnPress_Calibrator_Calibrate
);

static void OnPress_Calibrator_Calibrate(void)
{
    gStateFPGA.needCalibration = true;
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static const arrayItems itemsMath =
{
    (void*)&pppMath_Function,     // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß
    (void*)&pppMath_FFT           // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ
};

static const Page ppMath
(
    &pService, 0,
    "ÌÀÒÅÌÀÒÈÊÀ", "MATH",
    "Ìàòåìàòè÷åñêèå ôóíêöèè è ÁÏÔ",
    "Mathematical functions and FFT",
    Page_Math, &itemsMath
);

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static const arrayItems itemsMath_Function =
{
    (void*)&sbMath_Function_Exit,       // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Âûõîä
    (void*)&sbMath_Function_ModeDraw,   // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ýêðàí
    (void*)&sbMath_Function_Type,       // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Âèä
    (void*)&sbMath_Function_ModeRegSet, // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ðåæèì ðó÷êè ÓÑÒÀÍÎÂÊÀ
    (void*)&sbMath_Function_RangeA,     // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ìàñøòàá 1-ãî êàíàëà
    (void*)&sbMath_Function_RangeB      // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ìàñøòàá 2-ãî êàíàëà    
};

static const Page pppMath_Function
(
    &ppMath, IsActive_Math_Function,
    "ÔÓÍÊÖÈß", "FUNCTION",
    "Óñòàíîâêà è âûáîð ìàòåìàòè÷åñêîé ôóíêöèè - ñëîæåíèÿ èëè óìíîæåíèÿ",
    "Installation and selection of mathematical functions - addition or multiplication",
    Page_SB_MathFunction, &itemsMath_Function, OnPress_Math_Function, EmptyFuncVV, OnRegSet_Math_Function
);

void *PageService::Math::Function::GetPointer()
{
    return (void *)&pppMath_Function;
}

static bool IsActive_Math_Function(void)
{
    return !ENABLED_FFT;
}

static void OnPress_Math_Function(void)
{
    if (ENABLED_FFT)
    {
        Display::ShowWarningBad(ImpossibleEnableMathFunction);
    }
}

static void OnRegSet_Math_Function(int delta)
{
    if (DISABLED_DRAW_MATH)
    {
        return;
    }

    if (MATH_MODE_REG_SET_IS_RSHIFT)
    {
        int16 prevRShift = SET_RSHIFT_MATH;
        int16 rShift = prevRShift;
        if (delta > 0)
        {
            if (rShift < RShiftMax)
            {
                rShift += 4 * STEP_RSHIFT;
                LIMIT_ABOVE(rShift, RShiftMax);
                if (prevRShift < RShiftZero && rShift > RShiftZero)
                {
                    rShift = RShiftZero;
                }
                Sound::RegulatorShiftRotate();
                SET_RSHIFT_MATH = rShift;
            }
        }
        else if (delta < 0)
        {
            if (rShift > RShiftMin)
            {
                rShift -= 4 * STEP_RSHIFT;
                LIMIT_BELOW(rShift, RShiftMin);
                if (prevRShift > RShiftZero && rShift < RShiftZero)
                {
                    rShift = RShiftZero;
                }
                Sound::RegulatorShiftRotate();
                SET_RSHIFT_MATH = rShift;
            }
        }
    }
    if (MATH_MODE_REG_SET_IS_RANGE)
    {
        static int sum = 0;
        sum -= delta;

        float rShiftAbs = RSHIFT_2_ABS(SET_RSHIFT_MATH, SET_RANGE_MATH);

        if (sum > 2)
        {
            if (SET_RANGE_MATH < RangeSize - 1)
            {
                ++SET_RANGE_MATH;
                SET_RSHIFT_MATH = (int16)Math_RShift2Rel(rShiftAbs, SET_RANGE_MATH);
                Sound::RegulatorSwitchRotate();
            }
            sum = 0;
        }
        else if (sum < -2)
        {
            if (SET_RANGE_MATH > 0)
            {
                --SET_RANGE_MATH;
                SET_RSHIFT_MATH = (int16)Math_RShift2Rel(rShiftAbs, SET_RANGE_MATH);
                Sound::RegulatorSwitchRotate();
            }
            sum = 0;
        }
    }
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Âûõîä -------------------------------------------------------------------------------------------------------------
static const SmallButton sbMath_Function_Exit
(
    &pppMath_Function,
    COMMON_BEGIN_SB_EXIT,
    EmptyFuncVV,
    DrawSB_Exit
);

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ýêðàí -------------------------------------------------------------------------------------------------------------
static const arrayHints hintsMath_Function_ModeDraw =
{
    {Draw_Math_Function_ModeDraw_Disable,  "Âûâîä ìàòåìàòè÷åñêîé ôóíêöèè îòêëþ÷¸í",
                                            "The conclusion of mathematical function is disconnected"},
    {Draw_Math_Function_ModeDraw_Separate, "Ñèãíàëû è ìàòåìàòè÷åñêàÿ ôóíêöèÿ âûâîäÿòñÿ â ðàçíûõ îêíàõ",
                                            "Signals and mathematical function are removed in different windows"},
    {Draw_Math_Function_ModeDraw_Together, "Ñèãíàëû è ìàòåìàòè÷åñêàÿ ôóíêöèÿ âûâîäÿòñÿ â îäíîì îêíå",
                                            "Signals and mathematical function are removed in one window"}
};

static const SmallButton sbMath_Function_ModeDraw
(
    &pppMath_Function, 0,
    "Ýêðàí", "Display",
    "Âûáèðàåò ðåæèì îòîáðàæåíèÿ ìàòåìàòè÷åñêîãî ñèãíàëà",
    "Chooses the mode of display of a mathematical signal",
    OnPress_Math_Function_ModeDraw,
    Draw_Math_Function_ModeDraw,
    &hintsMath_Function_ModeDraw
);

static void OnPress_Math_Function_ModeDraw(void)
{
    if (ENABLED_FFT)
    {
        Display::ShowWarningBad(ImpossibleEnableMathFunction);
    }
    else
    {
        CircleIncreaseInt8((int8*)&MODE_DRAW_MATH, 0, 2);
    }
}

static void Draw_Math_Function_ModeDraw(int x, int y)
{
    static const pFuncVII funcs[3] =
    {
        Draw_Math_Function_ModeDraw_Disable,
        Draw_Math_Function_ModeDraw_Separate,
        Draw_Math_Function_ModeDraw_Together
    };
    funcs[MODE_DRAW_MATH](x, y);
}

static void Draw_Math_Function_ModeDraw_Disable(int x, int y)
{
    Painter::DrawText(x + 2 + (set.common.lang == English ? 2 : 0), y + 5, set.common.lang == Russian ? "Âûê" : "Dis");
}

static void Draw_Math_Function_ModeDraw_Separate(int x, int y)
{
    Painter::DrawRectangle(x + 3, y + 5, 13, 9);
    Painter::DrawHLine(y + 9, x + 3, x + 16);
    Painter::DrawHLine(y + 10, x + 3, x + 16);
}

static void Draw_Math_Function_ModeDraw_Together(int x, int y)
{
    Painter::DrawRectangle(x + 3, y + 5, 13, 9);
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Âèä ---------------------------------------------------------------------------------------------------------------
static const arrayHints hintsMath_Function_Type =
{
    { Draw_Math_Function_Type_Sum,      "Ñëîæåíèå",     "Addition"       },
    { Draw_Math_Function_Type_Mul,      "Óìíîæåíèå",    "Multiplication" }
};

static const SmallButton sbMath_Function_Type
(
    &pppMath_Function, 0,
    "Âèä", "Type",
    "Âûáîð ìàòåìàòè÷åñêîé ôóíêöèè",
    "Choice of mathematical function",
    OnPress_Math_Function_Type,
    Draw_Math_Function_Type,
    &hintsMath_Function_Type
);

static void OnPress_Math_Function_Type(void)
{
    CircleIncreaseInt8((int8*)&MATH_FUNC, 0, 1);
}

static void Draw_Math_Function_Type(int x, int y)
{
    const pFuncVII funcs[2] = {Draw_Math_Function_Type_Sum, Draw_Math_Function_Type_Mul};
    funcs[MATH_FUNC](x, y);
}

static void Draw_Math_Function_Type_Sum(int x, int y)
{
    Painter::DrawHLine(y + 9, x + 4, x + 14);
    Painter::DrawVLine(x + 9, y + 4, y + 14);
}

static void Draw_Math_Function_Type_Mul(int x, int y)
{
    Painter::SetFont(TypeFont_UGO2);
    Painter::Draw4SymbolsInRect(x + 4, y + 3, SYMBOL_MATH_FUNC_MUL);
    Painter::SetFont(TypeFont_8);
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ðåæèì ðó÷êè ÓÑÒÀÍÎÂÊÀ ---------------------------------------------------------------------------------------------
static const arrayHints hintsMath_Function_ModeRegSet =
{
    {Draw_Math_Function_ModeRegSet_Range,  "Óïðàâëåíèå ìàñøòàáîì", "Management of scale"},
    {Draw_Math_Function_ModeRegSet_RShift, "Óïðàâëåíèå ñìåùåíèåì", "Management of shift"}
};

static const SmallButton sbMath_Function_ModeRegSet
(
    &pppMath_Function, 0,
    "Ðåæèì ðó÷êè ÓÑÒÀÍÎÂÊÀ", "Mode regulator SET",
    "Âûáîð ðåæèìà ðó÷êè ÓÑÒÀÍÎÂÊÀ - óïðàâëåíèå ìàñøòàáîì èëè ñìåùåíèåì",
    "Choice mode regulcator ÓÑÒÀÍÎÂÊÀ - management of scale or shift",
    OnPress_Math_Function_ModeRegSet,
    Draw_Math_Function_ModeRegSet,
    &hintsMath_Function_ModeRegSet
);

static void OnPress_Math_Function_ModeRegSet(void)
{
    CircleIncreaseInt8((int8*)&MATH_MODE_REG_SET, 0, 1);
}

static void Draw_Math_Function_ModeRegSet(int x, int y)
{
    const pFuncVII funcs[2] = {Draw_Math_Function_ModeRegSet_Range, Draw_Math_Function_ModeRegSet_RShift};
    funcs[MATH_MODE_REG_SET](x, y);
}

static void Draw_Math_Function_ModeRegSet_Range(int x, int y)
{
    Painter::DrawChar(x + 7, y + 5, set.common.lang == Russian ? 'M' : 'S');
}

static void Draw_Math_Function_ModeRegSet_RShift(int x, int y)
{
    Painter::DrawText(x + 5 - (set.common.lang == English ? 3 : 0), y + 5, set.common.lang == Russian ? "Ñì" : "Shif");
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ìàñøòàá 1-ãî êàíàëà -----------------------------------------------------------------------------------------------
static const SmallButton sbMath_Function_RangeA
(
    &pppMath_Function, 0,
    "Ìàñøòàá 1-ãî êàíàëà", "Scale of the 1st channel",
    "Áåð¸ò ìàñøòàá äëÿ ìàòåìàòè÷åñêîãî ñèãíàëà èç ïåðâîãî êàíàëà",
    "Takes scale for a mathematical signal from the first channel",
    OnPress_Math_Function_RangeA,
    Draw_Math_Function_RangeA
);

static void OnPress_Math_Function_RangeA(void)
{
    SET_RANGE_MATH = SET_RANGE_A;
    MATH_MULTIPLIER = SET_DIVIDER_A;
}

static void Draw_Math_Function_RangeA(int x, int y)
{
    Painter::DrawChar(x + 8, y + 5, '1');
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÔÓÍÊÖÈß - Ìàñøòàá 2-ãî êàíàëà -----------------------------------------------------------------------------------------------
static const SmallButton sbMath_Function_RangeB
(
    &pppMath_Function, 0,
    "Ìàñøòàá 2-ãî êàíàëà", "Scale of the 2nd channel",
    "Áåð¸ò ìàñøòàá äëÿ ìàòåìàòè÷åñêîãî ñèãíàëà èç âòîðîãî êàíàëà",
    "Takes scale for a mathematical signal from the second channel",
    OnPress_Math_Function_RangeB,
    Draw_Math_Function_RangeB
);

static void OnPress_Math_Function_RangeB(void)
{
    SET_RANGE_MATH = SET_RANGE_B;
    MATH_MULTIPLIER = SET_DIVIDER_B;
}

static void Draw_Math_Function_RangeB(int x, int y)
{
    Painter::DrawChar(x + 8, y + 5, '2');
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static const arrayItems itemsMath_FFT =
{
    (void*)&cMath_FFT_Enable,       // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Îòîáðàæåíèå
    (void*)&cMath_FFT_Scale,        // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Øêàëà
    (void*)&cMath_FFT_Source,       // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Èñòî÷íèê
    (void*)&cMath_FFT_Window,       // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Îêíî
    (void*)&ppppMath_FFT_Cursors,   // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ
    (void*)&cMath_FFT_Limit         // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Äèàïàçîí
};

static const Page pppMath_FFT
(
    &ppMath, IsActive_Math_FFT,
    "ÑÏÅÊÒÐ", "SPECTRUM",
    "Îòîáðàæåíèå ñïåêòðà âõîäíîãî ñèãíàëà",
    "Mapping the input signal spectrum",
    Page_MathFFT, &itemsMath_FFT, OnPress_Math_FFT
);

static bool IsActive_Math_FFT(void)
{
    return DISABLED_DRAW_MATH;
}

static void OnPress_Math_FFT(void)
{
    if (!IsActive_Math_FFT())
    {
        Display::ShowWarningBad(ImpossibleEnableFFT);
    }
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Îòîáðàæåíèå --------------------------------------------------------------------------------------------------------
static const Choice cMath_FFT_Enable =
{
    Item_Choice, &pppMath_FFT, 0,
    {
        "Îòîáðàæåíèå", "Display",
        "Âêëþ÷àåò è âûêëþ÷àåò îòîáðàæåíèå ñïåêòðà",
        "Enables or disables the display of the spectrum"
    },
    {
        {DISABLE_RU,    DISABLE_EN},
        {ENABLE_RU,     ENABLE_EN}
    },
    (int8*)&ENABLED_FFT
};

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Øêàëà --------------------------------------------------------------------------------------------------------------
static const Choice cMath_FFT_Scale =
{
    Item_Choice, &pppMath_FFT, 0,
    {
        "Øêàëà", "Scale",
        "Çàäà¸ò ìàñøòàá âûâîäà ñïåêòðà - ëèíåéíûé èëè ëîãàðèôìè÷åñêèé",
        "Sets the scale of the output spectrum - linear or logarithmic"
    },
    {
        {"Ëîãàðèôì",    "Log"},
        {"Ëèíåéíàÿ",    "Linear"}
    },
    (int8*)&SCALE_FFT
};

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Èñòî÷íèê -----------------------------------------------------------------------------------------------------------
static const Choice cMath_FFT_Source =
{
    Item_Choice, &pppMath_FFT, 0,
    {
        "Èñòî÷íèê", "Source",
        "Âûáîð èñòî÷íèêà äëÿ ðàñ÷¸òà ñïåêòðà",
        "Selecting the source for the calculation of the spectrum"
    },
    {
        {"Êàíàë 1",     "Channel 1"},
        {"Êàíàë 2",     "Channel 2"},
        {"Êàíàë 1 + 2", "Channel 1 + 2"}
    },
    (int8*)&SOURCE_FFT
};

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Îêíî ---------------------------------------------------------------------------------------------------------------
static const Choice cMath_FFT_Window =
{
    Item_Choice, &pppMath_FFT, 0,
    {
        "Îêíî", "Window",
        "Çàäà¸ò îêíî äëÿ ðàñ÷¸òà ñïåêòðà",
        "Sets the window to calculate the spectrum"
    },
    {
        {"Ïðÿìîóãîëüí", "Rectangle"},
        {"Õýììèíãà",    "Hamming"},
        {"Áëýêìåíà",    "Blackman"},
        {"Õàííà",       "Hann"}
    },
    (int8*)&WINDOW_FFT
};

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ ------------------------------------------------------------------------------------------------------------
static const arrayItems itemsMath_FFT_Cursors =
{
    (void*)&cMath_FFT_Cursors_Exit,     // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ - Âûõîä
    (void*)&cMath_FFT_Cursors_Source,   // ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ - Èñòî÷íèê
    (void*)0,
    (void*)0,
    (void*)0,
    (void*)0
};

static const Page ppppMath_FFT_Cursors
(
    &pppMath_FFT, IsActive_Math_FFT_Cursors,
    "ÊÓÐÑÎÐÛ", "CURSORS",
    "Âêëþ÷àåò êóðñîðû äëÿ èçìåðåíèÿ ïàðàìåòðîâ ñïåêòðà",
    "Includes cursors to measure the parameters of the spectrum",
    Page_SB_MathCursorsFFT, &itemsMath_FFT_Cursors, EmptyFuncVV, EmptyFuncVV, OnRegSet_Math_FFT_Cursors
);

void *PageService::Math::FFT::Cursors::GetPointer()
{
    return (void *)&ppppMath_FFT_Cursors;
}

static bool IsActive_Math_FFT_Cursors(void)
{
    return ENABLED_FFT;
}

static void OnRegSet_Math_FFT_Cursors(int angle)
{
    FFT_POS_CURSOR(FFT_CUR_CURSOR) += (uint8)angle;
    Sound::RegulatorShiftRotate();
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ - Âûõîä ----------------------------------------------------------------------------------------------------
static const SmallButton cMath_FFT_Cursors_Exit
(
    &ppppMath_FFT_Cursors,
    COMMON_BEGIN_SB_EXIT,
    OnPress_Math_FFT_Cursors_Exit,
    DrawSB_Exit
);

static void OnPress_Math_FFT_Cursors_Exit(void)
{
    Display::RemoveAddDrawFunction();
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - ÊÓÐÑÎÐÛ - Èñòî÷íèê -------------------------------------------------------------------------------------------------
static const SmallButton cMath_FFT_Cursors_Source
(
    &ppppMath_FFT_Cursors, 0,
    "Èñòî÷íèê", "Source",
    "Âûáîð èñòî÷íèêà äëÿ ðàñ÷¸òà ñïåêòðà",
    "Source choice for calculation of a range",
    OnPress_Math_FFT_Cursors_Source,
    Draw_Math_FFT_Cursors_Source
);

static void OnPress_Math_FFT_Cursors_Source(void)
{
    FFT_CUR_CURSOR = (uint8)((FFT_CUR_CURSOR + 1) % 2);
}

static void Draw_Math_FFT_Cursors_Source(int x, int y)
{
    Painter::DrawText(x + 7, y + 5, FFT_CUR_CURSOR_IS_0 ? "1" : "2");
}

// ÑÅÐÂÈÑ - ÌÀÒÅÌÀÒÈÊÀ - ÑÏÅÊÒÐ - Äèàïàçîí -----------------------------------------------------------------------------------------------------------
static const Choice cMath_FFT_Limit =
{
    Item_Choice, &pppMath_FFT,  IsActive_Math_FFT_Limit,
    {
        "Äèàïàçîí", "Range",
        "Çäåñü ìîæíî çàäàòü ïðåäåë íàáëþäåíèÿ çà ìîùíîñòüþ ñïåêòðà",
        "Here you can set the limit of monitoring the power spectrum"
    },
    {
        {"-40äÁ",   "-40dB"},
        {"-60äÁ",   "-60dB"},
        {"-80äÁ",   "-80dB"}
    },
    (int8*)&FFT_MAX_DB
};

static bool IsActive_Math_FFT_Limit(void)
{
    return SCALE_FFT_IS_LOG;
}

// ÑÅÐÂÈÑ - ETHERNET /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static const arrayItems itemsEthernet =
{
    (void*)&cEthernet_Enable,       // ÑÅÐÂÈÑ - ETHERNET - Ethernet
    (void*)&ipEthernet_IP,          // ÑÅÐÂÈÑ - ETHERNET - IP àäðåñ
    (void*)&ipEthernet_Mask,        // ÑÅÐÂÈÑ - ETHERNET - Ìàñêà ïîäñåòè
    (void*)&ipEthernet_Gateway,     // ÑÅÐÂÈÑ - ETHERNET - Øëþç
    (void*)&macEthernet_MAC         // ÑÅÐÂÈÑ - ETHERNET - Ôèç àäðåñ
};

static const Page ppEthernet
(
    &pService, 0,
    "ETHERNET", "ETHERNET",
    "Íàñòðîéêè ethernet",
    "Settings of ethernet",
    Page_ServiceEthernet, &itemsEthernet
);

// ÑÅÐÂÈÑ - ETHERNET - Ethernet ----------------------------------------------------------------------------------------------------------------------
static const Choice cEthernet_Enable =
{
    Item_Choice, &ppEthernet, 0,
    {
        "Ethernet", "Ethernet"
        ,
        "×òîáû çàäåéñòâîâàòü ethernet, âûáåðèòå \"Âêëþ÷åíî\" è âûêëþ÷èòå ïðèáîð.\n"
        "×òîáû îòêëþ÷èòü ethernet, âûáåðèòå \"Îòêëþ÷åíî\" è âûêëþ÷èòå ïðèáîð."
        ,
        "To involve ethernet, choose \"Included\" and switch off the device.\n"
        "To disconnect ethernet, choose \"Disconnected\" and switch off the device."
    },
    {
        {"Âêëþ÷åíî",    "Included"},
        {"Îòêëþ÷åíî",   "Disconnected"}
    },
    (int8*)&ETH_ENABLE, OnChanged_Ethernet_Enable
};

static void OnChanged_Ethernet_Enable(bool active)
{
    Display::ShowWarningGood(NeedRebootDevice2);
    Display::ShowWarningGood(NeedRebootDevice1);
}

// ÑÅÐÂÈÑ - ETHERNET - IP àäðåñ ----------------------------------------------------------------------------------------------------------------------
static const IPaddressStruct structIP =
{
    Item_IP, &ppEthernet, 0,
    {   "IP àäðåñ", "IP-address",
        "Óñòàíîâêà IP àäðåñà",
        "Set of IP-address",  },
    &IP_ADDR0, &IP_ADDR1, &IP_ADDR2, &IP_ADDR3,
    OnChanged_Ethernet_Enable,
    &PORT
};

static const IPaddress ipEthernet_IP
(
    &structIP
);


// ÑÅÐÂÈÑ - ETHERNET - Ìàñêà ïîäñåòè -----------------------------------------------------------------------------------------------------------------
static const IPaddressStruct structMask =
{
    Item_IP, &ppEthernet, 0,
    {   "Ìàñêà ïîäñåòè", "Network mask",
        "Óñòàíîâêà ìàñêè ïîäñåòè",
        "Set of network mask",    },
    &NETMASK_ADDR0, &NETMASK_ADDR1, &NETMASK_ADDR2, &NETMASK_ADDR3,
    OnChanged_Ethernet_Enable    
};

static const IPaddress ipEthernet_Mask
(
    &structMask
);

// ÑÅÐÂÈÑ - ETHERNET - Øëþç --------------------------------------------------------------------------------------------------------------------------
static const IPaddressStruct structGateway =
{
    Item_IP, &ppEthernet, 0,
    {   "Øëþç", "Gateway",
        "Óñòàíîâêà àäðåñà îñíîâíîãî øëþçà",
        "Set of gateway address", },
    &GW_ADDR0, &GW_ADDR1, &GW_ADDR2, &GW_ADDR3,
    OnChanged_Ethernet_Enable
};

static const IPaddress ipEthernet_Gateway
(
    &structGateway
);

// ÑÅÐÂÈÑ - ETHERNET - Ôèç àäðåñ ---------------------------------------------------------------------------------------------------------------------
static const MACaddress macEthernet_MAC =
{
    Item_MAC, &ppEthernet, 0,
    {
        "Ôèç àäðåñ", "MAC-address",
        "Óñòàíîâêà ôèçè÷åñêîãî àäðåñà",
        "Set of MAC-address"
    },
    &MAC_ADDR0, &MAC_ADDR1, &MAC_ADDR2, &MAC_ADDR3, &MAC_ADDR4, &MAC_ADDR5,
    OnChanged_Ethernet_Enable
};

// ÑÅÐÂÈÑ - Çâóê -------------------------------------------------------------------------------------------------------------------------------------
static const Choice cSound =
{
    Item_Choice, &pService, 0,
    {
        "Çâóê", "Sound",
        "Âêëþ÷åíèå/âûêëþ÷åíèå çâóêà",
        "Inclusion/switching off of a sound"
    },
    {
        {DISABLE_RU,    DISABLE_EN},
        {ENABLE_RU,     ENABLE_EN}
    },
    (int8*)&SOUND_ENABLED
};


// ÑÅÐÂÈÑ - ßçûê -------------------------------------------------------------------------------------------------------------------------------------
static const Choice cLang =
{
    Item_Choice, &pService, 0,
    {
        "ßçûê", "Language",
        "Ïîçâîëÿåò âûáðàòü ÿçûê ìåíþ",
        "Allows you to select the menu language"
    },
    {
        {"Ðóññêèé",     "Russian"},
        {"Àíãëèéñêèé",  "English"}
    },
    (int8*)&LANG
};


// ÑÅÐÂÈÑ - Âðåìÿ ------------------------------------------------------------------------------------------------------------------------------------
static int8 dServicetime = 0;
static int8 hours = 0, minutes = 0, secondes = 0, year = 0, month = 0, day = 0;
static const Time tTime =
{
    Item_Time, &pService, 0,
    {
        "Âðåìÿ", "Time"
        ,
        "Óñòàíîâêà òåêóùåãî âðåìåíè.\nÏîðÿäîê ðàáîòû:\n"
        "Íàæàòü íà ýëåìåíò ìåíþ \"Âðåìÿ\". Îòêðîåòñÿ ìåíþ óñòàíîâêè òåêóùåãî âðåìåíè. Êîðîòêèìè íàæàòèÿìè êíîïêè íà öèôðîâîé êëàâèàòóðå, ñîîòâåòñâóþùåé "
        "ýëåìåíòó óïðàâëåíèÿ \"Âðåìÿ\", âûäåëèòü ÷àñû, ìèíóòû, ñåêóíäû, ãîä, ìåñÿö, èëè ÷èñëî. Âûäåëåííûé ýëåìåíò îáîçíà÷àåòñÿ ìèãàþùåé îáëàñòüþ. "
        "Âðàùåíèåì ðó÷êè ÓÑÒÀÍÎÂÊÀ óñòàíîâèòü íåîáõîäèìîå çíà÷åíèå. Çàòåì âûäåëèòü ïóíêò \"Ñîõðàíèòü\", íàæàòü è óäðåæèâàòü áîëåå 0.5 ñåê êíîïêó íà ïàíåëè "
        "óïðàâëåíèÿ. Ìåíþ óñòàíîâêè òåêóùåãî âðåìåíÿ çàêðîåòñÿ ñ ñîõðàíåíèåì íîâîãî òåêóùåãî âðåìåíè. Íàæàòèå äëèòåëüíîå óäåðæàíèå êíîïêè íà ëþáîì äðóãîì ýëåìåíòå "
        "ïðèâåä¸ò ê çàêðûòèþ ìåíþ óñòàíîâêè òåêóùåãî âðåìåíè áåç ñîõðàíåíèÿ íîâîãî òåêóùåãî âðåìåíè"
        ,
        "Setting the current time. \nPoryadok work:\n"
        "Click on the menu item \"Time\".The menu set the current time.By briefly pressing the button on the numeric keypad of conformity "
        "Control \"Time\", highlight the hours, minutes, seconds, year, month, or a number.The selected item is indicated by a flashing area. "
        "Turn the setting knob to set the desired value. Then highlight \"Save\", press and udrezhivat more than 0.5 seconds, the button on the panel "
        "Control. Menu Setting the current time will be closed to the conservation of the new current time. Pressing a button on the prolonged retention of any other element "
        "will lead to the closure of the current time setting menu without saving the new current time"
    },
    &dServicetime, &hours, &minutes, &secondes, &month, &day, &year
};

// ÑÅÐÂÈÑ - Ðåæ äëèò ÑÈÍÕÐ ---------------------------------------------------------------------------------------------------------------------------
static const Choice cModeLongPressButtonTrig =
{
    Item_Choice, &pService, 0,
    {
        "Ðåæ äëèò ÑÈÍÕÐ", "Mode long ÑÈÍÕÐ"
        ,
        "Óñòàíàâëèâàåò äåéñòâèÿ äëÿ äëèòåëüíîãî íàæàòèÿ êíîïêè ÑÈÍÕÐ:\n\"Ñáðîñ óðîâíÿ\" - óñòàíîâêà óðîâíÿ ñèíõðîíèçàöèè â íîëü,\n\"Àâòîóðîâåíü\" "
        "- àâòîìàòè÷åñêîå îïðåäåëåíèå è óñòàíîâêà óðîâíÿ ñèíõðîíèçàöèè"
        ,
        "Sets the action for long press CLOCK:\n\"Reset trig lvl\" - to set the trigger level to zero, \n\"Auto level\""
        "- Automatically detect and install the trigger level"
    },
    {
        {"Ñáðîñ óðîâíÿ",    "Reset trig level"},
        {"Àâòîóðîâåíü",     "Autolevel"}
    },
    (int8*)&MODE_LONG_PRESS_TRIG
};

// ÑÅÐÂÈÑ - ÈÍÔÎÐÌÀÖÈß -------------------------------------------------------------------------------------------------------------------------------
static const arrayItems itemsInformation =
{
    (void*)&sbInformation_Exit, // ÑÅÐÂÈÑ - ÈÍÔÎÐÌÀÖÈß - Âûõîä
    (void*)0,
    (void*)0,
    (void*)0,
    (void*)0,
    (void*)0
};

static const Page ppInformation
(
    &pService, 0,
    "ÈÍÔÎÐÌÀÖÈß", "INFORMATION",
    "Âûâîäèò íà ýêðàí èäåíòèôèêàöèîííûå äàííûå îñöèëëîãðàôà",
    "Displays identification data of the oscilloscope",
    Page_SB_Information, &itemsInformation, OnPress_Information, EmptyFuncVV, EmptyFuncVI
);

void *PageService::Information::GetPointer()
{
    return (void *)&ppInformation;
}

static void OnPress_Information(void)
{
    Menu::OpenPageAndSetItCurrent(PageService::Information::GetPointer());
    Display::SetDrawMode(DrawMode_Hand, Information_Draw);
}

static void Information_Draw(void)
{
    Language lang = LANG;

    Painter::BeginScene(COLOR_BLACK);
    int x = 100;
    int dY = 20;
    int y = 20;
    Painter::DrawRectangleC(0, 0, 319, 239, COLOR_FILL);
    y += dY;
    Painter::DrawText(x, y, lang == Russian ? "ÈÍÔÎÐÌÀÖÈß" : "INFORMATION");
    y += dY;
    Painter::DrawText(x, y, lang == Russian ? "Ìîäåëü : Ñ8-53/1" : "Model : S8-53/1");
    y += dY;

    char buffer[100];
    /*
    OTP_GetSerialNumber(buffer);
    if (buffer[0])
    {
        Painter::DrawFormatText(x, y, COLOR_FILL, lang == Russian ? "C/Í : %s" : "S/N : %s", buffer);
        y += dY;
    }
    */

    Painter::DrawText(x, y, lang == Russian ? "Ïðîãðàììíîå îáåñïå÷åíèå:" : "Software:");
    y += dY;
    sprintf(buffer, (const char*)((lang == Russian) ? "âåðñèÿ %s" : "version %s"), NUM_VER);
    Painter::DrawText(x, y, buffer);
    y += dY;

Painter::DrawFormatText(x, y, COLOR_FILL, "CRC32 : %X", Hardware::CalculateCRC32());

    dY = -10;
    Painter::DrawStringInCenterRect(0, 190 + dY, 320, 20, "Äëÿ ïîëó÷åíèÿ ïîìîùè íàæìèòå è óäåðæèâàéòå êíîïêó ÏÎÌÎÙÜ");
    Painter::DrawStringInCenterRect(0, 205 + dY, 320, 20, "Îòäåë ìàðêåòèíãà: òåë./ôàêñ. 8-017-270-02-00");
    Painter::DrawStringInCenterRect(0, 220 + dY, 320, 20, "Ðàçðàáîò÷èêè: e-mail: mnipi-24(@)tut.by, òåë. 8-017-270-02-23");

    Menu::Draw();
    Painter::EndScene();
}

// ÑÅÐÂÈÑ - ÈÍÔÎÐÌÀÖÈß - Âûõîä -----------------------------------------------------------------------------------------------------------------------
const SmallButton sbInformation_Exit
(
    &ppInformation,
    COMMON_BEGIN_SB_EXIT,
    OnPress_Information_Exit,
    DrawSB_Exit
);

static void OnPress_Information_Exit(void)
{
    Display::SetDrawMode(DrawMode_Auto, 0);
    Display::RemoveAddDrawFunction();
}


/** @}  @}
 */
